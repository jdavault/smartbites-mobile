[api]

[auth]
enabled = true
site_url = "https://dev.smartbites.food"
jwt_secret = "super-secret-local-jwt-key-change-me"
jwt_expiry = 3600

# Allow redirects from Expo, Studio, and API tunnels
additional_redirect_urls = [
  "https://dev.smartbites.food",        # Expo app tunnel
  "https://supabase-api.ngrok.io",      # Supabase API tunnel
  "https://supabase-studio.ngrok.io",   # Supabase Studio tunnel
  "http://localhost:8081",              # Expo web dev (your usual port)
  "exp://127.0.0.1:19000",
  "exp://192.168.7.131:19000",
  "http://localhost:8081/reset-password",
  "smartbites://reset-password",
  "https://dev.smartbites.food/reset-password",
  "https://smartbites.ngrok.io/reset-password",
  "https://smartbites.food/reset-password",
  "https://ahikcpeeuyaxyssscgqk.supabase.co/auth/v1/callback",
  "http://localhost:19006",
  "smartbites://",
  "smartbites://auth",
  "https://auth.expo.io/@jdavault01/allergy-aware-recipe-finder"
]

enable_refresh_token_rotation = true
refresh_token_reuse_interval = 10
enable_signup = true
enable_anonymous_sign_ins = false
enable_manual_linking = false
minimum_password_length = 6
password_requirements = ""

[auth.rate_limit]
email_sent = 2
sms_sent = 30
anonymous_users = 30
token_refresh = 150
sign_in_sign_ups = 30
token_verifications = 30
web3 = 30

[auth.email]
enable_signup = true
double_confirm_changes = true
enable_confirmations = false
secure_password_change = false
max_frequency = "1s"
otp_length = 6
otp_expiry = 3600

[auth.sms]
enable_signup = false
enable_confirmations = false
template = "Your code is {{ .Code }}"
max_frequency = "5s"

[auth.sms.twilio]
enabled = false
account_sid = ""
message_service_sid = ""
auth_token = "env(SUPABASE_AUTH_SMS_TWILIO_AUTH_TOKEN)"

[auth.mfa]
max_enrolled_factors = 10

[auth.mfa.totp]
enroll_enabled = false
verify_enabled = false

[auth.mfa.phone]
enroll_enabled = false
verify_enabled = false
otp_length = 6
template = "Your code is {{ .Code }}"
max_frequency = "5s"

# --- GOOGLE OAUTH PROVIDER ---
[auth.external.google]
enabled = true
client_id = "1010197305867-brcm0n9qc0v95ksrem0ljbiiktnout24.apps.googleusercontent.com"
secret = "env(SUPABASE_AUTH_EXTERNAL_GOOGLE_SECRET)"
redirect_uri = "https://supabase-api.ngrok.io/auth/v1/callback"

# --- APPLE OAUTH PROVIDER (stub for later) ---
[auth.external.apple]
enabled = true
client_id = "com.anonymous.allergy-aware-recipe-finder.signin"
secret = "env(SUPABASE_AUTH_EXTERNAL_APPLE_SECRET)"
redirect_uri = "https://supabase-api.ngrok.io/auth/v1/callback"
skip_nonce_check = false
